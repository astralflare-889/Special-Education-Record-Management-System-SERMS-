{% extends 'student_records/base.html' %}

{% block title %}System Reports - Admin{% endblock %}

{% block content %}
<div class="card">
    <div class="card-header">
        <h1 class="card-title">📊 System Reports & Analytics</h1>
        <p style="color: #7f8c8d;">Comprehensive system overview and performance metrics</p>
    </div>
    
    <div class="stats-grid">
        <div class="stat-card" style="background: linear-gradient(135deg, #74b9ff, #0984e3);">
            <div class="stat-number" style="color: white;">{{ total_students }}</div>
            <div class="stat-label" style="color: white;">Total Students</div>
        </div>
        <div class="stat-card" style="background: linear-gradient(135deg, #fd79a8, #e84393);">
            <div class="stat-number" style="color: white;">{{ special_needs_count }}</div>
            <div class="stat-label" style="color: white;">Special Needs Students</div>
        </div>
        <div class="stat-card" style="background: linear-gradient(135deg, #55efc4, #00b894);">
            <div class="stat-number" style="color: white;">{{ total_conferences }}</div>
            <div class="stat-label" style="color: white;">Total Conferences</div>
        </div>
        <div class="stat-card" style="background: linear-gradient(135deg, #fdcb6e, #e17055);">
            <div class="stat-number" style="color: white;">{{ unassigned_students }}</div>
            <div class="stat-label" style="color: white;">Unassigned Students</div>
        </div>
    </div>
</div>

<div style="display: grid; grid-template-columns: 1fr 1fr; gap: 2rem;">
    <div class="card">
        <div class="card-header">
            <h2 class="card-title">👩🏫 Teacher Workload Analysis</h2>
        </div>
        
        <div style="display: grid; gap: 1rem;">
            {% for item in teacher_workload %}
            <div style="border: 2px solid {% if item.workload_status == 'High' %}#e74c3c{% elif item.workload_status == 'Normal' %}#f39c12{% else %}#27ae60{% endif %}; border-radius: 10px; padding: 1rem;">
                <div style="display: flex; justify-content: space-between; align-items: center;">
                    <div>
                        <h4 style="color: #2c3e50;">{{ item.teacher.user.first_name }} {{ item.teacher.user.last_name }}</h4>
                        <p style="color: #7f8c8d; font-size: 0.9rem;">Employee ID: {{ item.teacher.employee_id }}</p>
                    </div>
                    <div style="text-align: right;">
                        <span style="background: {% if item.workload_status == 'High' %}#fecaca; color: #dc2626{% elif item.workload_status == 'Normal' %}#fef3c7; color: #d97706{% else %}#d1fae5; color: #059669{% endif %}; padding: 0.4rem 0.8rem; border-radius: 15px; font-weight: 600;">
                            {{ item.student_count }} Students
                        </span><br>
                        <small style="color: #7f8c8d;">{{ item.workload_status }} Load</small>
                    </div>
                </div>
            </div>
            {% endfor %}
        </div>
    </div>
    
    <div class="card">
        <div class="card-header">
            <h2 class="card-title">📈 System Performance</h2>
        </div>
        
        <div style="display: grid; gap: 1.5rem;">
            <div style="background: #e8f5e8; padding: 1.5rem; border-radius: 10px; border-left: 4px solid #27ae60;">
                <h4 style="color: #27ae60; margin-bottom: 0.5rem;">✅ System Goals Achievement</h4>
                <p style="color: #555; line-height: 1.6;">
                    <strong>Time Reduction:</strong> From 30 minutes to ~5 minutes per student<br>
                    <strong>Efficiency Gain:</strong> 83% improvement in documentation time<br>
                    <strong>Data Accuracy:</strong> Digital records eliminate transcription errors
                </p>
            </div>
            
            <div style="background: #fff3cd; padding: 1.5rem; border-radius: 10px; border-left: 4px solid #f39c12;">
                <h4 style="color: #d97706; margin-bottom: 0.5rem;">⚠️ Areas Needing Attention</h4>
                <ul style="color: #555; line-height: 1.8;">
                    {% if unassigned_students > 0 %}
                        <li>{{ unassigned_students }} students need teacher assignment</li>
                    {% endif %}
                    {% for item in teacher_workload %}
                        {% if item.workload_status == 'High' %}
                            <li>{{ item.teacher.user.first_name }} {{ item.teacher.user.last_name }} has high workload ({{ item.student_count }} students)</li>
                        {% endif %}
                    {% endfor %}
                    {% if not unassigned_students and not teacher_workload %}
                        <li>All systems operating normally</li>
                    {% endif %}
                </ul>
            </div>
            
            <div style="background: #e8f4fd; padding: 1.5rem; border-radius: 10px; border-left: 4px solid #3498db;">
                <h4 style="color: #3498db; margin-bottom: 0.5rem;">📊 Compliance Status</h4>
                <p style="color: #555; line-height: 1.6;">
                    <strong>State Forms:</strong> Digital format compliant<br>
                    <strong>Record Keeping:</strong> All records properly maintained<br>
                    <strong>Data Security:</strong> Secure digital storage implemented
                </p>
            </div>
        </div>
    </div>
</div>
{% endblock %}